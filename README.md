# LLM Классификация отзывов с маркетплейсов

## Цель
Научить LLM-модель классифицировать отзывы с маркетплейсов по категориям товаров, к которым они относятся.
[Подробное описание задачи](data/README.md)

## Данные
- **data/train.csv** — неразмеченные отзывы для обучения.
- **data/test.csv** — отзывы для тестирования модели.
- **data/categories.txt** — Список категорий товаров, на которые необходимо классифицировать отзывы

## Этапы решения

### 1. Подготовка данных
1.1. Получение данных (`train.csv`, `test.csv`, `categories.txt`)  
1.2. Предобработка текста (`clean_text`) — удаление HTML-тегов, спецсимволов, перевод в нижний регистр

### 2. Автоматическая разметка train
2.1. Загрузка и подготовка LLM Mistral-7B-Instruct  
2.2. Тестирование LLM автолейблинга на небольшой выборке  
2.3. Разметка по ключевым словам (`category_keywords`, `regex_label`)  
2.4. Комбинация методов на всем датасете с помощью батчинга  
2.5. Кластеризация отзывов (альтернативная разметка, неиспользуемая)

### 3. Классификация отзывов с помощью RuBert
3.1. Подготовка данных (train/val split, `LabelEncoder`, `Dataset`, токенизация)  
3.2. Обучение на размеченном train
- Подбор гиперпараметров (learning rate, batch size, weight decay, количество эпох)  
- Полное fine-tuning модели  
- Дообучение с LoRA

3.3. Разметка тестовых отзывов (инференс, замер скорости, сохранение CSV)

## Результаты
- Классификатор достиг Weighted F1 ~0.77 на валидации.
- Среднее время инференса на один отзыв ~0.002 сек.

## Вывод
- Модель успешно обучена на размеченном датасете.  
- Weighted F1 на валидации демонстрирует хорошую точность.  
- Решение соответствует требованиям кейса: автоматическая разметка, обучение LLM, различные методы дообучения, оценка качества по метрике Weighted F1, замер скорости инференса.

